import React from 'react';
import { ChatPlatform, ThemeColors } from '../types';

interface InputBarProps {
  platform: ChatPlatform;
  theme: ThemeColors;
}

/**
 * Chat input bar matching WhatsApp's exact design from Figma.
 * Features:
 * - Plus button for attachments
 * - Message input field with emoji button inside
 * - Camera button
 * - Microphone button for voice messages
 */
export const InputBar: React.FC<InputBarProps> = ({ platform, theme }) => {
  const isWhatsApp = platform === 'whatsapp';
  
  // Scale factor: 1080/375 = 2.88
  const SCALE = 2.88;

  const containerStyle: React.CSSProperties = {
    display: 'flex',
    alignItems: 'center',
    padding: isWhatsApp ? `${12 * SCALE}px ${10 * SCALE}px` : `${8 * SCALE}px ${12 * SCALE}px`,
    gap: 8 * SCALE,
    backgroundColor: theme.inputBarBg,
    borderTop: platform !== 'whatsapp' ? '1px solid #E5E5E5' : 'none',
    flexShrink: 0,
  };

  const inputContainerStyle: React.CSSProperties = {
    flex: 1,
    display: 'flex',
    alignItems: 'center',
    padding: isWhatsApp ? `${10 * SCALE}px ${14 * SCALE}px` : `${10 * SCALE}px ${16 * SCALE}px`,
    borderRadius: 21 * SCALE,
    border: 'none',
    backgroundColor: theme.inputFieldBg,
    gap: 10 * SCALE,
  };

  const inputTextStyle: React.CSSProperties = {
    flex: 1,
    color: theme.inputPlaceholder,
    fontSize: isWhatsApp ? 17 * SCALE : 15 * SCALE, // ~49px
  };

  if (platform === 'whatsapp') {
    const iconSize = 24 * SCALE; // ~69px
    const smallIconSize = 22 * SCALE;
    const iconColor = '#0A1014'; // Exact color from Figma
    
    return (
      <div style={containerStyle}>
        {/* Plus icon - thin outlined style */}
        <div style={{ padding: `${4 * SCALE}px`, display: 'flex', alignItems: 'center' }}>
          <svg width={iconSize} height={iconSize} viewBox="0 0 24 24" fill="none">
            <path
              d="M12 5v14M5 12h14"
              stroke={iconColor}
              strokeWidth="1.5"
              strokeLinecap="round"
            />
          </svg>
        </div>

        {/* Input field container */}
        <div style={inputContainerStyle}>
          {/* Empty input field - no placeholder text */}
          <div style={{ flex: 1 }} />

          {/* Sticker icon - StickerSwitchSticker.svg from WA_Code */}
          <svg width={smallIconSize} height={smallIconSize} viewBox="0 0 24 24" fill="none">
            <path fillRule="evenodd" clipRule="evenodd" d="M16.151 19.1652C15.0086 20.2163 13.5219 20.8161 11.9682 20.8535L11.5577 20.864L10.2603 20.9017L9.95089 20.9075L9.62323 20.8968C9.04467 20.8738 8.58078 20.8312 8.11302 20.7476C7.46929 20.633 6.89199 20.4452 6.35376 20.1742C5.79709 19.8949 5.29095 19.5313 4.85002 19.0945C4.40782 18.6581 4.04044 18.1585 3.75782 17.6093C3.48371 17.0778 3.29356 16.5059 3.1764 15.8655C3.09343 15.4074 3.04993 14.944 3.02679 14.393L3.01519 14.0512L3.00813 13.7322C3.00721 13.678 3.00642 13.6232 3.00574 13.5678L3.0026 13.1714L3 11.3388L3.00406 10.5242L3.00812 10.1887L3.01517 9.87006L3.02678 9.5278C3.04995 8.97611 3.09354 8.5125 3.17688 8.05274C3.29293 7.41616 3.48315 6.84446 3.75746 6.31145C4.04009 5.76184 4.40734 5.26243 4.8482 4.8273C5.29031 4.38939 5.79624 4.02589 6.35143 3.74716C6.891 3.47491 7.46839 3.28714 8.11198 3.17288C8.66545 3.07373 9.21261 3.03218 9.95939 3.01237L11.1487 3L13.3928 3.00373C13.5612 3.00506 13.686 3.00659 13.7921 3.00849L14.3025 3.02329C14.8807 3.04631 15.344 3.08894 15.8112 3.17269C16.4561 3.28711 17.0336 3.47488 17.5708 3.74616C18.1278 4.02561 18.6339 4.38901 19.0746 4.82549C19.5179 5.26311 19.8851 5.76276 20.1653 6.30979C20.4414 6.84445 20.6318 7.41636 20.747 8.05293C20.8477 8.60456 20.89 9.14836 20.9091 9.86805C20.9148 10.0667 20.9185 10.2702 20.9205 10.4821L20.9219 10.697L20.9236 11.3388L20.9223 11.3792L20.8602 12.3697C20.76 13.9745 20.0628 15.4816 18.9053 16.5905L18.3443 17.124C17.9505 17.4962 17.5181 17.9004 17.0547 18.3304L16.151 19.1652ZM10.4018 19.3969L10.2244 19.4021L9.96135 19.407L9.67765 19.3977C9.14534 19.3764 8.75418 19.3384 8.37591 19.2708C7.86235 19.1794 7.42545 19.0344 7.02836 18.8345L7.02642 18.8335C6.61101 18.6251 6.23412 18.3542 5.9056 18.0288L5.90375 18.027C5.57377 17.7013 5.30117 17.3302 5.09159 16.9229L5.09095 16.9217C4.89107 16.5341 4.74528 16.1054 4.65215 15.5969C4.58547 15.2283 4.54702 14.8391 4.52572 14.336L4.51463 14.0092L4.50785 13.703C4.50702 13.6535 4.50629 13.6035 4.50567 13.5527L4.50563 13.5495L4.50259 13.1644L4.50001 11.3415L4.50401 10.537L4.50792 10.2144L4.51461 9.91207L4.52571 9.58482C4.54704 9.08103 4.58559 8.69144 4.65269 8.32101C4.74452 7.81767 4.89039 7.38805 5.09143 6.99741C5.30105 6.58977 5.57349 6.21902 5.90191 5.89486L5.90379 5.893C6.23377 5.56615 6.61062 5.29546 7.02445 5.0877L7.02714 5.08634C7.42499 4.8856 7.86135 4.74083 8.37418 4.64979L8.3765 4.64938C8.82235 4.5695 9.28289 4.53114 9.98723 4.51216L11.1552 4.50001L13.3856 4.50372C13.5441 4.50498 13.6602 4.5064 13.7571 4.5081L14.2508 4.52242C14.7811 4.54376 15.1698 4.58162 15.5466 4.64916L15.5492 4.64963C16.0637 4.74092 16.4999 4.88577 16.8947 5.08515L16.8982 5.08688C17.3142 5.29562 17.691 5.56632 18.019 5.89121L18.0208 5.89303C18.3522 6.22008 18.6238 6.59059 18.8302 6.99358L18.8325 6.99804C19.0348 7.38977 19.1801 7.81817 19.271 8.32011L19.2714 8.32229C19.3528 8.76807 19.3916 9.227 19.4096 9.90774L19.4097 9.91121C19.4133 10.0384 19.4162 10.1681 19.4182 10.3017L19.32 10.3V10.4273C19.3147 10.6258 19.3035 10.773 19.2806 10.9007C19.2587 11.0202 19.2251 11.1209 19.178 11.2123C19.13 11.3054 19.068 11.3898 18.9931 11.4637C18.9165 11.5396 18.8304 11.6015 18.7354 11.6491C18.6402 11.6972 18.5357 11.7312 18.4085 11.754C18.2801 11.7769 18.1357 11.7879 17.93 11.7933L17.4986 11.7976L17.277 11.7968C16.6943 11.8118 16.2742 11.8436 15.844 11.9207C15.337 12.011 14.8789 12.1602 14.4498 12.3766C14.0085 12.5974 13.605 12.8873 13.2526 13.2368C12.9023 13.5826 12.6092 13.9807 12.384 14.418C12.1655 14.8436 12.0145 15.2977 11.9231 15.7998C11.8452 16.2283 11.8124 16.6563 11.798 17.1967L11.7928 17.8007L11.7902 17.9325C11.785 18.1253 11.7736 18.2743 11.7506 18.4024C11.7285 18.5224 11.695 18.6231 11.6482 18.7136C11.5998 18.8079 11.5379 18.8921 11.463 18.966C11.3864 19.0419 11.3003 19.1038 11.2053 19.1514C11.1099 19.1995 11.0061 19.2332 10.8799 19.2557C10.7496 19.2791 10.6057 19.2938 10.3999 19.2992L10.4018 19.3969ZM13.1981 19.1565C13.2527 19.008 13.2947 18.8523 13.3248 18.6883C13.3554 18.518 13.3726 18.352 13.3822 18.1668L13.3926 17.8248L13.3977 17.2257C13.4098 16.7739 13.4372 16.4163 13.4972 16.0861C13.561 15.7358 13.6622 15.4315 13.8069 15.1497C13.9541 14.8639 14.1463 14.6028 14.378 14.3741C14.6114 14.1426 14.8763 13.9523 15.168 13.8063C15.4572 13.6605 15.7671 13.5596 16.1254 13.4957C16.4597 13.4359 16.8103 13.4093 17.298 13.3965L17.9611 13.393C18.2515 13.3854 18.4652 13.3691 18.6904 13.329C18.8777 13.2953 19.0537 13.2469 19.2211 13.1821C18.997 14.0644 18.5313 14.8709 17.8694 15.5056L17.8676 15.5073L17.314 16.0338L17.3124 16.0353C16.9234 16.4029 16.4955 16.803 16.0357 17.2296L16.0345 17.2307L15.1354 18.0613L15.1342 18.0625C14.5776 18.5742 13.914 18.9463 13.1981 19.1565Z" fill={iconColor}/>
          </svg>
        </div>

        {/* Camera icon - outlined style matching Figma */}
        <div style={{ padding: `${4 * SCALE}px`, display: 'flex', alignItems: 'center' }}>
          <svg width={iconSize} height={iconSize} viewBox="0 0 23 19" fill="none">
            <path d="M3.06641 18.623C1.02539 18.623 0 17.6074 0 15.5957V5.37109C0 3.35938 1.02539 2.35352 3.06641 2.35352H5.2832C6.04492 2.35352 6.28906 2.1875 6.71875 1.70898L7.5 0.830078C7.98828 0.292969 8.48633 0 9.49219 0H13.3887C14.3945 0 14.8926 0.292969 15.3809 0.830078L16.1719 1.70898C16.6016 2.19727 16.8457 2.35352 17.6074 2.35352H19.8828C21.9238 2.35352 22.9492 3.35938 22.9492 5.37109V15.5957C22.9492 17.6074 21.9238 18.623 19.8828 18.623H3.06641ZM3.08594 17.0508H19.8633C20.8301 17.0508 21.377 16.5332 21.377 15.5176V5.45898C21.377 4.44336 20.8301 3.92578 19.8633 3.92578H17.2168C16.3379 3.92578 15.8594 3.75977 15.3809 3.21289L14.6094 2.35352C14.0527 1.72852 13.7695 1.57227 12.9004 1.57227H9.98047C9.12109 1.57227 8.83789 1.72852 8.27148 2.35352L7.50977 3.21289C7.02148 3.75977 6.55273 3.92578 5.67383 3.92578H3.08594C2.12891 3.92578 1.57227 4.44336 1.57227 5.45898V15.5176C1.57227 16.5332 2.12891 17.0508 3.08594 17.0508ZM11.4746 15.498C8.52539 15.498 6.15234 13.125 6.15234 10.1562C6.15234 7.1875 8.52539 4.81445 11.4746 4.81445C14.4336 4.81445 16.8066 7.1875 16.8066 10.1562C16.8066 13.125 14.4336 15.498 11.4746 15.498ZM18.4961 7.77344C17.832 7.77344 17.2852 7.23633 17.2852 6.57227C17.2852 5.89844 17.832 5.36133 18.4961 5.36133C19.1602 5.36133 19.707 5.89844 19.707 6.57227C19.707 7.23633 19.1602 7.77344 18.4961 7.77344ZM11.4746 14.0137C13.6035 14.0137 15.332 12.2949 15.332 10.1562C15.332 8.01758 13.6035 6.29883 11.4746 6.29883C9.3457 6.29883 7.62695 8.01758 7.62695 10.1562C7.62695 12.2949 9.35547 14.0137 11.4746 14.0137Z" fill={iconColor}/>
          </svg>
        </div>

        {/* Microphone icon - outlined style */}
        <div style={{ padding: `${4 * SCALE}px`, display: 'flex', alignItems: 'center' }}>
          <svg width={iconSize} height={iconSize} viewBox="0 0 24 24" fill="none">
            <path
              d="M12 2a3.5 3.5 0 00-3.5 3.5v6a3.5 3.5 0 007 0v-6A3.5 3.5 0 0012 2z"
              stroke={iconColor}
              strokeWidth="1.5"
              fill="none"
            />
            <path
              d="M19 10v1.5a7 7 0 01-14 0V10M12 18.5V22M8 22h8"
              stroke={iconColor}
              strokeWidth="1.5"
              strokeLinecap="round"
            />
          </svg>
        </div>
      </div>
    );
  }

  // iMessage / Messenger style
  return (
    <div style={containerStyle}>
      {platform === 'messenger' && (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <circle cx="12" cy="12" r="10" stroke={theme.inputIcon} strokeWidth="2" fill="none" />
          <path d="M12 8v8M8 12h8" stroke={theme.inputIcon} strokeWidth="2" strokeLinecap="round" />
        </svg>
      )}
      <div style={inputContainerStyle}>
        <div style={inputTextStyle}>
          {platform === 'imessage' ? 'iMessage' : 'Aa'}
        </div>
      </div>
      {platform === 'imessage' ? (
        <div
          style={{
            width: 32,
            height: 32,
            borderRadius: '50%',
            backgroundColor: theme.inputIcon,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
          }}
        >
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M2 8h12M8 2l6 6-6 6" stroke="#FFFFFF" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
          </svg>
        </div>
      ) : (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M2 21l21-9L2 3v7l15 2-15 2v7z" fill={theme.inputIcon} />
        </svg>
      )}
    </div>
  );
};
